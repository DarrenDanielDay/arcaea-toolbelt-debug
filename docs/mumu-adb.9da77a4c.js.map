{"mappings":"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","sources":["src/docs/shared.ts","src/utils/click-elsewhere.ts","src/utils/component.ts","src/utils/download.ts","src/docs/mumu-adb/index.ts","node_modules/@parcel/runtime-js/lib/bundles/runtime-ad243e5927d85bd7.js"],"sourcesContent":["import { clickElsewhere } from \"../utils/click-elsewhere\";\r\nimport { query } from \"../utils/component\";\r\nimport \"./shared.css\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nexport const docsPage = (content: string) => {\r\n  document.body.innerHTML = content;\r\n  const refs = query({\r\n    tocMenu: \"aside header\",\r\n    tocPanel: \"div.toc-wrapper\",\r\n    toc: `ul#toc`,\r\n  } as const)(document);\r\n  const { toc, tocMenu, tocPanel } = refs;\r\n  const hideToc = () => {\r\n    toc.classList.toggle(\"visible\", false);\r\n  };\r\n  clickElsewhere(tocPanel, () => {\r\n    hideToc();\r\n  });\r\n  tocMenu.onclick = () => {\r\n    toc.classList.toggle(\"visible\");\r\n  };\r\n  toc.querySelectorAll(\"li > a[href]\").forEach((link) => {\r\n    link.onclick = () => {\r\n      hideToc();\r\n    };\r\n  });\r\n  document.querySelectorAll(\"img\").forEach((img) => {\r\n    img.onclick = () => {\r\n      const isFullScreen = !!document.fullscreenElement;\r\n      if (isFullScreen) {\r\n        document.exitFullscreen();\r\n      } else {\r\n        img.requestFullscreen({ navigationUI: \"show\" });\r\n      }\r\n    };\r\n  });\r\n};\r\n","export const clickElsewhere = (panel: Element, onClick: (e: MouseEvent) => void) => {\r\n  const handler = (e: MouseEvent) => {\r\n    const path = e.composedPath();\r\n    if (!path.includes(panel)) {\r\n      onClick(e);\r\n    }\r\n  };\r\n  window.addEventListener(\"click\", handler);\r\n  return () => {\r\n    window.removeEventListener(\"click\", handler);\r\n  };\r\n};\r\n","import { ParseSelector } from \"typed-query-selector/parser\";\r\nimport { attr, element, listen, registerDirective } from \"hyplate\";\r\nimport type { ClassComponentInstance, CleanUpFunc, JSXDirective } from \"hyplate/types\";\r\n\r\nexport const css = String.raw;\r\n\r\nexport const query =\r\n  <T extends Record<string, string>>(queries: T): Query<T> =>\r\n  (host) =>\r\n    // @ts-expect-error Dynamic Implementation\r\n    Object.fromEntries(Object.entries(queries).map(([key, value]) => [key, host.querySelector(value)]));\r\n\r\nexport type Query<T extends Record<string, string>> = (host: ParentNode) => Refs<T>;\r\n\r\nexport type Refs<T extends Record<string, string>> = {\r\n  [K in keyof T]: ParseSelector<T[K]>;\r\n};\r\n\r\nexport type RefsOf<Q> = Q extends Query<infer T> ? Refs<T> : never;\r\n\r\nexport const input = () => element(\"input\");\r\n\r\nexport const syncProps = (component: ClassComponentInstance) => {\r\n  const props = component.props;\r\n  for (const key in props) {\r\n    if (key !== \"ref\" && key !== \"children\") {\r\n      // @ts-expect-error dynamic key property\r\n      const value = props[key];\r\n      if (typeof value === \"string\" || typeof value === \"number\" || typeof value === \"boolean\") {\r\n        attr(component, key, value);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nexport class EnterSubmitDirective implements JSXDirective<boolean> {\r\n  prefix = \"keypress-submit\";\r\n  requireParams = false;\r\n  apply(el: Element, _params: string | null, input: boolean): void | CleanUpFunc {\r\n    if (input && el instanceof HTMLInputElement) {\r\n      return listen(el)(\"keypress\", (e) => {\r\n        if (e.key.toLowerCase() === \"enter\") el.form?.requestSubmit();\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nregisterDirective(new EnterSubmitDirective());\r\n\r\ndeclare module \"hyplate/types\" {\r\n  export interface ElementDirectives<E extends Element> {\r\n    \"keypress-submit\"?: boolean;\r\n  }\r\n}\r\n","export function download(url: string, filename: string) {\r\n  const link = document.createElement(\"a\");\r\n  link.download = filename;\r\n  link.href = url;\r\n  link.click();\r\n}\r\n\r\nexport function downloadJSON(json: object, filename: string) {\r\n  const url = URL.createObjectURL(new Blob([JSON.stringify(json, undefined, 2) + \"\\n\"], { type: \"application/json\" }));\r\n  download(url, filename);\r\n}\r\n","import { docsPage } from \"../shared\";\r\nimport html from \"bundle-text:./index.html\";\r\nimport { query } from \"../../utils/component\";\r\nimport { download } from \"../../utils/download\";\r\n\r\ndocsPage(html);\r\n\r\nfunction parseWindowsPath(value: string) {\r\n  const pattern = /^(\\w:)([\\\\\\/]\\w+)*/;\r\n  const match = value.match(pattern);\r\n  if (!match) return null;\r\n  const [_, root, rest] = match;\r\n  return {\r\n    root,\r\n    rest,\r\n  };\r\n}\r\n\r\nfunction isValidPath(value: string) {\r\n  const parsed = parseWindowsPath(value);\r\n  if (!parsed) return false;\r\n  const { root } = parsed;\r\n  return !!root;\r\n}\r\n\r\nfunction generateScriptContent(\r\n  installOrShellPath: string,\r\n  port: number,\r\n  exportFolder: string\r\n): [valid: boolean, content: string] {\r\n  if (!isValidPath(installOrShellPath)) {\r\n    return [false, \"MuMu模拟器安装路径或shell路径不正确\"];\r\n  }\r\n  const maxPort = 65535;\r\n  if (isNaN(port) || port < 0 || port > maxPort) {\r\n    return [false, `端口不正确，应当是0~${maxPort}的整数`];\r\n  }\r\n  if (!isValidPath(exportFolder)) {\r\n    return [false, \"导出路径不正确\"];\r\n  }\r\n  const { root } = parseWindowsPath(installOrShellPath)!;\r\n  const shellPath =\r\n    installOrShellPath.split(/[\\\\\\/]/).at(-1) === \"shell\"\r\n      ? installOrShellPath\r\n      : installOrShellPath.replace(/[\\\\\\/]?$/, \"\\\\shell\");\r\n  return [\r\n    true,\r\n    `\\\r\n${root}\r\ncd \"${shellPath}\"\r\n.\\\\adb.exe kill-server\r\n.\\\\adb.exe start-server\r\n.\\\\adb.exe connect 127.0.0.1:${port}\r\n.\\\\adb.exe -s 127.0.0.1:${port} pull /data/data/moe.low.arc/files/st3 \"${exportFolder}\"\r\npause\r\n`,\r\n  ];\r\n}\r\n\r\nfunction bindInputs() {\r\n  const { installPath, port, exportPath, scriptContent, downloadScript } = query({\r\n    installPath: \"input#install-path\",\r\n    port: \"input#port\",\r\n    exportPath: \"input#export-path\",\r\n    scriptContent: \"div#script-content\",\r\n    downloadScript: \"button#download-script\",\r\n  } as const)(document.body);\r\n  let script = \"\";\r\n  let valid = false;\r\n  function updateScript() {\r\n    [valid, script] = generateScriptContent(installPath.value, port.valueAsNumber, exportPath.value);\r\n  }\r\n  function handleChange() {\r\n    updateScript();\r\n    scriptContent.textContent = script;\r\n    downloadScript.disabled = !valid;\r\n  }\r\n  function downloadScriptFile() {\r\n    if (valid) {\r\n      download(URL.createObjectURL(new Blob([script], { type: \"text/plain\" })), \"extract-st3.bat\");\r\n    }\r\n  }\r\n  for (const input of [installPath, port, exportPath]) {\r\n    input.oninput = handleChange;\r\n    input.onchange = handleChange;\r\n    input.onpaste = handleChange;\r\n  }\r\n  downloadScript.onclick = downloadScriptFile;\r\n  handleChange();\r\n}\r\n\r\nbindInputs();\r\n","module.exports = \"4e820eed6edbdd1f\";"],"names":[],"version":3,"file":"mumu-adb.9da77a4c.js.map"}